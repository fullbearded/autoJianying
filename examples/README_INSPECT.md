# 草稿元素信息查看工具

这个脚本用于分析和展示剪映草稿的详细信息，包括轨道、片段、素材等元素。

## 功能特性

### 1. 草稿列表查看
- 列出草稿文件夹中的所有草稿
- 显示每个草稿的基本信息（分辨率、时长、轨道数、素材数）

### 2. 详细草稿信息
- **基本信息**: 草稿名称、分辨率、总时长、帧率
- **轨道信息**: 轨道类型统计、每条轨道的详细信息
- **片段信息**: 每个片段的时间范围、速度、可见性等
- **素材信息**: 按类型分类显示所有素材的详细信息
- **元数据**: 特效、转场、滤镜、贴纸等额外信息

### 3. 素材使用分析
- 分析每个素材的使用情况
- 统计素材使用次数和总时长
- 识别未使用的素材
- 显示素材在不同轨道类型中的分布

### 4. 报告导出
- 将检查结果保存到文本文件
- 便于后续分析和存档

## 使用方法

### 基本用法

1. **列出所有草稿**:
```bash
python examples/inspect_draft.py --list
```

2. **检查特定草稿的详细信息**:
```bash
python examples/inspect_draft.py --draft-name "草稿名称"
```

3. **分析素材使用情况**:
```bash
python examples/inspect_draft.py --draft-name "草稿名称" --usage
```

4. **保存检查报告**:
```bash
python examples/inspect_draft.py --draft-name "草稿名称" --save "report.txt"
```

### 自定义草稿文件夹

如果你的草稿文件夹不在默认位置，可以指定路径：

```bash
python examples/inspect_draft.py --draft-folder "/path/to/your/drafts" --list
```

### 参数说明

- `--draft-folder, -d`: 指定草稿文件夹路径
- `--draft-name, -n`: 要检查的草稿名称
- `--list, -l`: 列出所有草稿
- `--usage, -u`: 分析素材使用情况
- `--save, -s`: 保存检查报告到指定文件

## 输出示例

### 草稿列表输出
```
📋 可用草稿列表
────────────────────────────────────────────────────────────
📁 草稿文件夹: /Users/xxx/Movies/JianyingPro/User Data/Projects/com.lveditor.draft
📊 找到 5 个草稿:
   1. 我的项目_A住B在C和
      分辨率: 1920x1080
      时长: 15.5s
      轨道数: 4
      素材数: 8
   2. 测试草稿_D还E行F毒
      分辨率: 1920x1080
      时长: 12.3s
      轨道数: 3
      素材数: 6
```

### 详细草稿信息输出
```
🔍 草稿详细信息: 我的项目_A住B在C和
════════════════════════════════════════════════════════════════════════════════

📋 基本信息
────────────────────────────────────────────────────────────
草稿名称: 我的项目_A住B在C和
分辨率: 1920 x 1080
总时长: 15.50 秒 (15500000 微秒)
帧率: 30.0 fps

📋 轨道信息
────────────────────────────────────────────────────────────
轨道总数: 4
轨道类型统计:
  video: 1 条
  audio: 1 条
  text: 2 条

📄 轨道 1: video
────────────────────────────────────────
ID: track_video_001
属性: 0
标志: 0
片段数: 3
片段详情:
    片段 1:
      ID: segment_001
      素材ID: material_001
      源时间: 0.00s - 5.00s (时长: 5.00s)
      目标时间: 0.00s - 5.00s (时长: 5.00s)
      速度: 1.0x
      可见: 是
      位置: x=0.000, y=0.000
      缩放: x=1.000, y=1.000
      透明度: 1.00
```

### 素材使用分析输出
```
📋 素材使用统计
────────────────────────────────────────────────────────────
总素材数: 8
已使用素材数: 6
未使用素材数: 2

📄 已使用素材详情
────────────────────────────────────────
素材: A住.mp4 (videos)
  使用次数: 1
  总使用时长: 5.00s
  片段分布: video

素材: background.jpg (images)
  使用次数: 1
  总使用时长: 15.50s
  片段分布: video

📄 未使用素材
────────────────────────────────────────
  extra_video.mp4 (videos)
  unused_audio.mp3 (audios)
```

## 技术说明

### 支持的素材类型
- **视频素材**: 显示尺寸、时长、路径等信息
- **音频素材**: 显示时长、路径等信息
- **图片素材**: 显示尺寸、路径等信息
- **文本素材**: 显示文本内容、字体、大小、颜色等
- **特效素材**: 显示资源ID和相关信息

### 轨道类型
- **video**: 视频轨道，包含视频片段和图片
- **audio**: 音频轨道，包含音频片段
- **text**: 文本轨道，包含字幕和文本
- **effect**: 特效轨道
- **filter**: 滤镜轨道
- **sticker**: 贴纸轨道

### 数据来源
脚本直接读取草稿文件夹中的 `draft_info.json` 文件，这是剪映存储草稿信息的标准格式。

## 注意事项

1. **权限要求**: 确保有读取草稿文件夹的权限
2. **文件完整性**: 草稿文件夹必须包含完整的 `draft_info.json` 文件
3. **版本兼容性**: 支持剪映5.0+版本的草稿格式
4. **大文件处理**: 对于包含大量素材的草稿，分析可能需要一些时间

## 故障排除

### 常见错误

1. **草稿文件夹不存在**
   - 检查路径是否正确
   - 确认剪映是否已安装并创建过草稿

2. **无法读取草稿信息**
   - 检查 `draft_info.json` 文件是否存在
   - 确认文件没有被损坏或加密

3. **权限拒绝**
   - 确保有读取草稿文件夹的权限
   - 在macOS上可能需要给予终端访问文档文件夹的权限

### 调试建议

使用 `--list` 参数先检查是否能正确列出草稿，再进行详细分析：

```bash
# 先测试基本功能
python examples/inspect_draft.py --list

# 再分析特定草稿
python examples/inspect_draft.py --draft-name "草稿名称"
```